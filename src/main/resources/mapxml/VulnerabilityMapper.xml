<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jia.jnmap.mapper.VulnerabilityMapper">


    <!--auto generated by MybatisCodeHelper on 2019-11-07-->
    <sql id="Base_Column_List">
        ID,
        CVE_ID,
        `NAME`,
        PUBLISHED,
        MODIFIED,
        `SOURCE`,
        SEVERITY,
        VULNERABILITY_TYPE,
        THR_TYPE,
        VULNERABILITY_DESC,
        VULNERABILITY_SOLUTION,
        CNNVD_MATCH_RULES,
        CNNVD_REFS,
        CVE_MATCH_RULES,
        CVE_REFS,
        CVSS_BASE_SCORE,
        CVSS_EXPLOITABILITY_SCORE,
        CVSS_IMPACT_SCORE
        <!--            PRODUCTS-->
    </sql>

    <sql id="Base_Column_List1">
        ID,
        CVE_ID,
        `NAME`,
        PUBLISHED,
        MODIFIED,
        `SOURCE`,
        SEVERITY,
        VULNERABILITY_TYPE,
        THR_TYPE,
        VULNERABILITY_DESC,
        VULNERABILITY_SOLUTION,
        CVSS_BASE_SCORE,
        CVSS_EXPLOITABILITY_SCORE,
        CVSS_IMPACT_SCORE
        <!--            PRODUCTS-->
    </sql>

    <resultMap id="BaseResultMap" type="com.jia.jnmap.entity.Vulnerability">
        <result column="ID" property="id"/>
        <result column="CVE_ID" property="cveId"/>
        <result column="NAME" property="name"/>
        <result column="PUBLISHED" property="published"/>
        <result column="MODIFIED" property="modified"/>
        <result column="SOURCE" property="source"/>
        <result column="SEVERITY" property="severity"/>
        <result column="VULNERABILITY_TYPE" property="vulnerabilityType"/>
        <result column="THR_TYPE" property="thrtype"/>
        <result column="VULNERABILITY_DESC" property="vulnerabilityDesc"/>
        <result column="VULNERABILITY_SOLUTION" property="vulnerabilitySolution"/>
        <result column="CNNVD_MATCH_RULES" property="cnnvdMatchRules"/>
        <result column="CNNVD_REFS" property="cnnvdRefs"/>
        <result column="CVE_MATCH_RULES" property="cveMatchRules"/>
        <result column="CVE_REFS" property="cveRefs"/>
        <result column="CVSS_BASE_SCORE" property="cvssBaseScore"/>
        <result column="CVSS_EXPLOITABILITY_SCORE" property="cvssExploitabilityScore"/>
        <result column="CVSS_IMPACT_SCORE" property="cvssImpactScore"/>
        <!--        <result column="PRODUCTS" property="products"/>-->
    </resultMap>

    <resultMap id="BaseResultMap1" type="com.jia.jnmap.entity.VulnMatchRule">
        <result column="ID" property="id"/>
        <result column="CNNVD_MATCH_RULES" property="cnnvdMatchRules"/>
        <result column="CVE_MATCH_RULES" property="cveMatchRules"/>
    </resultMap>

    <resultMap id="BaseResultMap2" type="com.jia.jnmap.entity.VulnBaseInfo">
        <result column="ID" property="id"/>
        <result column="CVE_ID" property="cveId"/>
        <result column="NAME" property="name"/>
        <result column="PUBLISHED" property="published"/>
        <result column="MODIFIED" property="modified"/>
        <result column="SOURCE" property="source"/>
        <result column="SEVERITY" property="severity"/>
        <result column="VULNERABILITY_TYPE" property="vulnerabilityType"/>
        <result column="THR_TYPE" property="thrtype"/>
        <result column="VULNERABILITY_DESC" property="vulnerabilityDesc"/>
        <result column="VULNERABILITY_SOLUTION" property="vulnerabilitySolution"/>
        <result column="CVSS_BASE_SCORE" property="cvssBaseScore"/>
        <result column="CVSS_EXPLOITABILITY_SCORE" property="cvssExploitabilityScore"/>
        <result column="CVSS_IMPACT_SCORE" property="cvssImpactScore"/>
        <!--        <result column="PRODUCTS" property="products"/>-->
    </resultMap>

    <!--auto generated by MybatisCodeHelper on 2019-11-11-->
    <insert id="insertSelective">
        INSERT INTO TBL_VULNERABILITY
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="vulnerability.id!=null">ID,</if>
            <if test="vulnerability.cveId!=null">CVE_ID,</if>
            <if test="vulnerability.name!=null">NAME,</if>
            <if test="vulnerability.published!=null">PUBLISHED,</if>
            <if test="vulnerability.modified!=null">MODIFIED,</if>
            <if test="vulnerability.source!=null">SOURCE,</if>
            <if test="vulnerability.severity!=null">SEVERITY,</if>
            <if test="vulnerability.vulnerabilityType!=null">VULNERABILITY_TYPE,</if>
            <if test="vulnerability.thrtype!=null">THR_TYPE,</if>
            <if test="vulnerability.vulnerabilityDesc!=null">VULNERABILITY_DESC,</if>
            <if test="vulnerability.vulnerabilitySolution!=null">VULNERABILITY_SOLUTION,</if>
            <if test="vulnerability.cnnvdMatchRules!=null">CNNVD_MATCH_RULES,</if>
            <if test="vulnerability.cnnvdRefs!=null">CNNVD_REFS,</if>
            <if test="vulnerability.cveMatchRules!=null">CVE_MATCH_RULES,</if>
            <if test="vulnerability.cveRefs!=null">CVE_REFS,</if>
            <if test="vulnerability.cvssBaseScore!=null">CVSS_BASE_SCORE,</if>
            <if test="vulnerability.cvssExploitabilityScore!=null">CVSS_EXPLOITABILITY_SCORE,</if>
            <if test="vulnerability.cvssImpactScore!=null">CVSS_IMPACT_SCORE</if>
        </trim>
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="vulnerability.id!=null">#{vulnerability.id},</if>
            <if test="vulnerability.cveId!=null">#{vulnerability.cveId},</if>
            <if test="vulnerability.name!=null">#{vulnerability.name},</if>
            <if test="vulnerability.published!=null">#{vulnerability.published},</if>
            <if test="vulnerability.modified!=null">#{vulnerability.modified},</if>
            <if test="vulnerability.source!=null">#{vulnerability.source},</if>
            <if test="vulnerability.severity!=null">#{vulnerability.severity},</if>
            <if test="vulnerability.vulnerabilityType!=null">#{vulnerability.vulnerabilityType},</if>
            <if test="vulnerability.thrtype!=null">#{vulnerability.thrtype},</if>
            <if test="vulnerability.vulnerabilityDesc!=null">#{vulnerability.vulnerabilityDesc},</if>
            <if test="vulnerability.vulnerabilitySolution!=null">#{vulnerability.vulnerabilitySolution},</if>
            <if test="vulnerability.cnnvdMatchRules!=null">#{vulnerability.cnnvdMatchRules},</if>
            <if test="vulnerability.cnnvdRefs!=null">#{vulnerability.cnnvdRefs},</if>
            <if test="vulnerability.cveMatchRules!=null">#{vulnerability.cveMatchRules},</if>
            <if test="vulnerability.cveRefs!=null">#{vulnerability.cveRefs},</if>
            <if test="vulnerability.cvssBaseScore!=null">#{vulnerability.cvssBaseScore},</if>
            <if test="vulnerability.cvssExploitabilityScore!=null">#{vulnerability.cvssExploitabilityScore},</if>
            <if test="vulnerability.cvssImpactScore!=null">#{vulnerability.cvssImpactScore}</if>
        </trim>
    </insert>

    <!--auto generated by MybatisCodeHelper on 2019-11-12-->
    <update id="updateByCveId">
        update TBL_VULNERABILITY
        <set>
            <if test="updated.id != null">
                ID = #{updated.id},
            </if>
            <if test="updated.cveId != null">
                CVE_ID = #{updated.cveId},
            </if>
            <if test="updated.name != null">
                NAME = #{updated.name},
            </if>
            <if test="updated.published != null">
                PUBLISHED = #{updated.published},
            </if>
            <if test="updated.modified != null">
                MODIFIED = #{updated.modified},
            </if>
            <if test="updated.source != null">
                SOURCE = #{updated.source},
            </if>
            <if test="updated.severity != null">
                SEVERITY = #{updated.severity},
            </if>
            <if test="updated.vulnerabilityType != null">
                VULNERABILITY_TYPE = #{updated.vulnerabilityType},
            </if>
            <if test="updated.thrtype != null">
                THR_TYPE = #{updated.thrtype},
            </if>
            <if test="updated.vulnerabilityDesc != null">
                VULNERABILITY_DESC = #{updated.vulnerabilityDesc},
            </if>
            <if test="updated.vulnerabilitySolution != null">
                VULNERABILITY_SOLUTION = #{updated.vulnerabilitySolution},
            </if>
            <if test="updated.cnnvdMatchRules != null">
                CNNVD_MATCH_RULES = #{updated.cnnvdMatchRules},
            </if>
            <if test="updated.cnnvdRefs != null">
                CNNVD_REFS = #{updated.cnnvdRefs},
            </if>
            <if test="updated.cveMatchRules != null">
                CVE_MATCH_RULES = #{updated.cveMatchRules},
            </if>
            <if test="updated.cveRefs != null">
                CVE_REFS = #{updated.cveRefs},
            </if>
            <if test="updated.cvssBaseScore != null">
                CVSS_BASE_SCORE = #{updated.cvssBaseScore},
            </if>
            <if test="updated.cvssExploitabilityScore != null">
                CVSS_EXPLOITABILITY_SCORE = #{updated.cvssExploitabilityScore},
            </if>
            <if test="updated.cvssImpactScore != null">
                CVSS_IMPACT_SCORE = #{updated.cvssImpactScore},
            </if>
        </set>
        where CVE_ID=#{cveId}
    </update>

    <!--auto generated by MybatisCodeHelper on 2019-11-13-->
    <select id="selectAllVulnMathRule" resultMap="BaseResultMap1">
        select ID, CNNVD_MATCH_RULES, CVE_MATCH_RULES
        from TBL_VULNERABILITY
    </select>

    <select id="scanByPage" resultMap="BaseResultMap1">
        SELECT ID, CNNVD_MATCH_RULES, CVE_MATCH_RULES
        FROM TBL_VULNERABILITY
        ORDER BY ID
        LIMIT #{limit} OFFSET #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-13-->
    <select id="selectAll" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from TBL_VULNERABILITY
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-18-->
    <select id="selectOneById" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from TBL_VULNERABILITY
        where ID=#{id}
    </select>

    <select id="selectAllVulnBaseInfoByIds" resultMap="BaseResultMap2">
        select
        <include refid="Base_Column_List1"/>
        from TBL_VULNERABILITY
        where ID in
        <foreach collection="ids" item="id" index="index"
                 open="(" close=")" separator=",">
            #{id}
        </foreach>
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-18-->
    <update id="updateById">
        update TBL_VULNERABILITY
        <set>
            <if test="updated.id != null">
                ID = #{updated.id},
            </if>
            <if test="updated.cveId != null">
                CVE_ID = #{updated.cveId},
            </if>
            <if test="updated.name != null">
                NAME = #{updated.name},
            </if>
            <if test="updated.published != null">
                PUBLISHED = #{updated.published},
            </if>
            <if test="updated.modified != null">
                MODIFIED = #{updated.modified},
            </if>
            <if test="updated.source != null">
                SOURCE = #{updated.source},
            </if>
            <if test="updated.severity != null">
                SEVERITY = #{updated.severity},
            </if>
            <if test="updated.vulnerabilityType != null">
                VULNERABILITY_TYPE = #{updated.vulnerabilityType},
            </if>
            <if test="updated.thrtype != null">
                THR_TYPE = #{updated.thrtype},
            </if>
            <if test="updated.vulnerabilityDesc != null">
                VULNERABILITY_DESC = #{updated.vulnerabilityDesc},
            </if>
            <if test="updated.vulnerabilitySolution != null">
                VULNERABILITY_SOLUTION = #{updated.vulnerabilitySolution},
            </if>
            <if test="updated.cnnvdMatchRules != null">
                CNNVD_MATCH_RULES = #{updated.cnnvdMatchRules},
            </if>
            <if test="updated.cnnvdRefs != null">
                CNNVD_REFS = #{updated.cnnvdRefs},
            </if>
            <if test="updated.cveMatchRules != null">
                CVE_MATCH_RULES = #{updated.cveMatchRules},
            </if>
            <if test="updated.cveRefs != null">
                CVE_REFS = #{updated.cveRefs},
            </if>
            <if test="updated.cvssBaseScore != null">
                CVSS_BASE_SCORE = #{updated.cvssBaseScore},
            </if>
            <if test="updated.cvssExploitabilityScore != null">
                CVSS_EXPLOITABILITY_SCORE = #{updated.cvssExploitabilityScore},
            </if>
            <if test="updated.cvssImpactScore != null">
                CVSS_IMPACT_SCORE = #{updated.cvssImpactScore},
            </if>
        </set>
        where ID=#{id}
    </update>

    <!--auto generated by MybatisCodeHelper on 2019-11-29-->
    <select id="selectByPublishedTime" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from TBL_VULNERABILITY where `PUBLISHED` &gt;= #{start} and `PUBLISHED` &lt;= #{end} limit #{limit} offset
        #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-29-->
    <select id="countByPublishedTime" resultType="java.lang.Integer">
        select count(1)
        from TBL_VULNERABILITY
        where `PUBLISHED` &gt;= #{start}
          and `PUBLISHED` &lt;= #{end}
        limit #{limit} offset
            #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-29-->
    <select id="selectByPublishedTimeAndId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from TBL_VULNERABILITY
        where `PUBLISHED` &gt;= #{start} and `PUBLISHED` &lt;= #{end} and `ID` like CONCAT('%', #{id}, '%') limit
        #{limit} offset
        #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-29-->
    <select id="countByPublishedTimeAndId" resultType="java.lang.Integer">
        select count(1)
        from TBL_VULNERABILITY
        where `PUBLISHED` &gt;= #{start}
          and `PUBLISHED` &lt;= #{end}
          and `ID` like CONCAT('%', #{id}, '%')
        limit #{limit} offset
            #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-29-->
    <select id="selectByPublishedTimeAndName" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from TBL_VULNERABILITY
        where `PUBLISHED` &gt;= #{start} and `PUBLISHED` &lt;= #{end} and `NAME` like CONCAT('%', #{name}, '%') limit
        #{limit} offset
        #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-29-->
    <select id="countByPublishedTimeAndName" resultType="java.lang.Integer">
        select count(1)
        from TBL_VULNERABILITY
        where `PUBLISHED` &gt;= #{start}
          and `PUBLISHED` &lt;= #{end}
          and `NAME` like CONCAT('%', #{name}, '%')
        limit #{limit} offset
            #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-29-->
    <select id="selectByPublishedTimeAndIdAndName" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from TBL_VULNERABILITY
        where `PUBLISHED` &gt;= #{start} and `PUBLISHED` &lt;= #{end} and `ID` like CONCAT('%', #{id}, '%') and `NAME`
        like
        CONCAT('%', #{name}, '%') limit #{limit} offset #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-29-->
    <select id="countByPublishedTimeAndIdAndName" resultType="java.lang.Integer">
        select count(1)
        from TBL_VULNERABILITY
        where `PUBLISHED` &gt;= #{start}
          and `PUBLISHED` &lt;= #{end}
          and `ID` like CONCAT('%', #{id}, '%')
          and `NAME` like CONCAT('%', #{name}, '%')
        limit #{limit} offset #{offset}
    </select>

    <!--auto generated by MybatisCodeHelper on 2019-11-07-->
</mapper>
