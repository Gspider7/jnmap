package com.jia.jnmap.mapper;

import com.jia.jnmap.entity.VulnBaseInfo;
import com.jia.jnmap.entity.VulnMatchRule;
import com.jia.jnmap.entity.Vulnerability;
import org.apache.ibatis.annotations.Param;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
public interface VulnerabilityMapper {

    int insertSelective(@Param("vulnerability") Vulnerability vulnerability);

    int updateByCveId(@Param("updated") Vulnerability updated, @Param("cveId") String cveId);

    List<VulnMatchRule> selectAllVulnMathRule();

    List<Vulnerability> selectAll();

    Vulnerability selectOneById(@Param("id") String id);

    List<VulnBaseInfo> selectAllVulnBaseInfoByIds(@Param("ids") List<String> ids);

    int updateById(@Param("updated") Vulnerability updated, @Param("id") String id);

    List<Vulnerability> selectByPublishedTime(@Param("start") String start, @Param("end") String end, @Param("limit") Integer limit, @Param("offset") Integer offset);

    Integer countByPublishedTime(@Param("start") String start, @Param("end") String end, @Param("limit") Integer limit, @Param("offset") Integer offset);


    List<Vulnerability> selectByPublishedTimeAndId(@Param("start") String start, @Param("end") String end, @Param("id") String id, @Param("limit") Integer limit, @Param("offset") Integer offset);

    Integer countByPublishedTimeAndId(@Param("start") String start, @Param("end") String end, @Param("id") String id, @Param("limit") Integer limit, @Param("offset") Integer offset);


    List<Vulnerability> selectByPublishedTimeAndName(@Param("start") String start, @Param("end") String end, @Param("name") String name, @Param("limit") Integer limit, @Param("offset") Integer offset);

    Integer countByPublishedTimeAndName(@Param("start") String start, @Param("end") String end, @Param("name") String name, @Param("limit") Integer limit, @Param("offset") Integer offset);


    List<Vulnerability> selectByPublishedTimeAndIdAndName(@Param("start") String start, @Param("end") String end, @Param("id") String id, @Param("name") String name, @Param("limit") Integer limit, @Param("offset") Integer offset);

    Integer countByPublishedTimeAndIdAndName(@Param("start") String start, @Param("end") String end, @Param("id") String id, @Param("name") String name, @Param("limit") Integer limit, @Param("offset") Integer offset);


}
