package com.jia.jnmap.entity;

import com.jia.jnmap.nmap.entity.MatchRule;
import com.jia.jnmap.nmap.entity.Ref;

import java.util.ArrayList;
import java.util.Objects;

public class Vulnerability {

    private String id;

    private String cveId;

    private String name;

    private String published;

    private String modified;

    private String source;

    private String severity;

    private String vulnerabilityType;

    private String thrtype;

    private String vulnerabilityDesc;

    private String vulnerabilitySolution;

    private ArrayList<MatchRule> cnnvdMatchRules;

    private ArrayList<Ref> cnnvdRefs;

    private ArrayList<MatchRule> cveMatchRules;

    private ArrayList<Ref> cveRefs;

    private Integer cvssBaseScore;

    private Integer cvssExploitabilityScore;

    private Integer cvssImpactScore;

//    private ArrayList<String> products;

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getCveId() {
        return cveId;
    }

    public void setCveId(String cveId) {
        this.cveId = cveId;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getPublished() {
        return published;
    }

    public void setPublished(String published) {
        this.published = published;
    }

    public String getModified() {
        return modified;
    }

    public void setModified(String modified) {
        this.modified = modified;
    }

    public String getSource() {
        return source;
    }

    public void setSource(String source) {
        this.source = source;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }

    public String getVulnerabilityType() {
        return vulnerabilityType;
    }

    public void setVulnerabilityType(String vulnerabilityType) {
        this.vulnerabilityType = vulnerabilityType;
    }

    public String getThrtype() {
        return thrtype;
    }

    public void setThrtype(String thrtype) {
        this.thrtype = thrtype;
    }

    public String getVulnerabilityDesc() {
        return vulnerabilityDesc;
    }

    public void setVulnerabilityDesc(String vulnerabilityDesc) {
        this.vulnerabilityDesc = vulnerabilityDesc;
    }

    public ArrayList<MatchRule> getCnnvdMatchRules() {
        return cnnvdMatchRules;
    }

    public void setCnnvdMatchRules(ArrayList<MatchRule> cnnvdMatchRules) {
        this.cnnvdMatchRules = cnnvdMatchRules;
    }

    public ArrayList<Ref> getCnnvdRefs() {
        return cnnvdRefs;
    }

    public void setCnnvdRefs(ArrayList<Ref> cnnvdRefs) {
        this.cnnvdRefs = cnnvdRefs;
    }

    public ArrayList<MatchRule> getCveMatchRules() {
        return cveMatchRules;
    }

    public void setCveMatchRules(ArrayList<MatchRule> cveMatchRules) {
        this.cveMatchRules = cveMatchRules;
    }

    public ArrayList<Ref> getCveRefs() {
        return cveRefs;
    }

    public void setCveRefs(ArrayList<Ref> cveRefs) {
        this.cveRefs = cveRefs;
    }

    public String getVulnerabilitySolution() {
        return vulnerabilitySolution;
    }

    public void setVulnerabilitySolution(String vulnerabilitySolution) {
        this.vulnerabilitySolution = vulnerabilitySolution;
    }

    public Integer getCvssBaseScore() {
        return cvssBaseScore;
    }

    public void setCvssBaseScore(Integer cvssBaseScore) {
        this.cvssBaseScore = cvssBaseScore;
    }

    public Integer getCvssExploitabilityScore() {
        return cvssExploitabilityScore;
    }

    public void setCvssExploitabilityScore(Integer cvssExploitabilityScore) {
        this.cvssExploitabilityScore = cvssExploitabilityScore;
    }

    public Integer getCvssImpactScore() {
        return cvssImpactScore;
    }

    public void setCvssImpactScore(Integer cvssImpactScore) {
        this.cvssImpactScore = cvssImpactScore;
    }

//    public ArrayList<String> getProducts() {
//        return products;
//    }
//
//    public void setProducts(ArrayList<String> products) {
//        this.products = products;
//    }
//
//    public void addProduct(String product) {
//        if (products == null) {
//            products = new ArrayList<>();
//        }
//        products.add(product);
//    }

    public int compare(Vulnerability vulnerability) {
        if (Objects.equals(this.cvssBaseScore, vulnerability.getCvssBaseScore())) {
            return 0;
        }
        Integer v2s = vulnerability.getCvssBaseScore();
        if (this.cvssBaseScore == null) {
            return 1;
        }
        if (v2s == null) {
            return -1;
        }
        return this.cvssBaseScore > v2s ? -1 : 1;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Vulnerability that = (Vulnerability) o;
        return Objects.equals(id, that.id);
    }

    @Override
    public int hashCode() {
        return Objects.hash(id);
    }

    @Override
    public String toString() {
        return "Vulnerability{" +
                "id='" + id + '\'' +
                ", cveId='" + cveId + '\'' +
                ", name='" + name + '\'' +
                ", published='" + published + '\'' +
                ", modified='" + modified + '\'' +
                ", source='" + source + '\'' +
                ", severity='" + severity + '\'' +
                ", vulnerabilityType='" + vulnerabilityType + '\'' +
                ", thrtype='" + thrtype + '\'' +
                ", vulnerabilityDesc='" + vulnerabilityDesc + '\'' +
                ", vulnerabilitySolution='" + vulnerabilitySolution + '\'' +
                ", cnnvdMatchRules=" + cnnvdMatchRules +
                ", cnnvdRefs=" + cnnvdRefs +
                ", cveMatchRules=" + cveMatchRules +
                ", cveRefs=" + cveRefs +
                ", cvssBaseScore=" + cvssBaseScore +
                ", cvssExploitabilityScore=" + cvssExploitabilityScore +
                ", cvssImpactScore=" + cvssImpactScore +
                '}';
    }
}
